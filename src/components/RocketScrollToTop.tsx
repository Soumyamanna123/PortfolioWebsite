"use client";
import { FC, useEffect, useRef, useState } from "react";
interface IProps {
  className?: string;
}
import { cn } from "@/lib/utils";

const RocketScrollToTop: FC<IProps> = ({ className }) => {
  const elementRef = useRef<HTMLButtonElement>(null);
  const [scrollPosition, setScrollPosition] = useState(0);
  const [rocketLaunch, setRocketLaunch] = useState(false);

  const handleRocketLaunch = () => {
    setRocketLaunch(true);
    calculateButtonPosition();
    window.scrollTo({
      top: 0,
      behavior: "smooth", // Add smooth scrolling behavior
    });
  };

  useEffect(() => {
    function handleScroll() {
      const currentPosition = window.scrollY;
      if (currentPosition <= 300) {
        setRocketLaunch(false);
      }
    }
    // Attach the scroll event listener when the component mounts
    window.addEventListener("scroll", handleScroll);
    return () => {
      window.removeEventListener("scroll", handleScroll);
    };
  }, []);

  function calculateButtonPosition() {
    if (elementRef.current) {
      const rect = elementRef.current.getBoundingClientRect();
      setScrollPosition(rect.top);
    }
  }

  return (
    <div id="FooterScrollToTopWrapper" className={className}>
      <div
        data-module=""
        className="Module StudyPortals_Shared_Modules_Footer_FooterScrollToTop_FooterScrollToTop"
      >
        <div id="FooterScrollToTop">
          <button
            className={cn(
              "FooterScrollToTopButton canHover",
              rocketLaunch ? "FooterRocketLaunch" : "",
            )}
            id="js-FooterScrollToTopClick"
            ref={elementRef}
            title="Scroll to top"
            onClick={handleRocketLaunch}
          >
            <span
              className={cn(
                "FooterScrollToTopRocket",
                rocketLaunch ? "shakeRocket flyRocket" : "",
              )}
              id="js-FooterScrollToTopAnimate"
              style={{ top: rocketLaunch ? scrollPosition : undefined }}
            >
              <svg
                id="ToTopRocketSVG"
                viewBox="0 0 23 64"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                xmlnsXlink="http://www.w3.org/1999/xlink"
              >
                <defs>
                  <path
                    d="M9.41593903 14.1209893c-1.03049752.9923723-1.03049752 2.6043019 0 3.5957737 1.03049747.9914718 2.70681087.9914718 3.73637247 0 1.0304975-.9914718 1.0304975-2.6034014 0-3.5957737-1.0295616-.9914718-2.705875-.9914718-3.73637247 0m4.98214197 4.7934644c-1.7165599 1.6515524-4.51135155 1.6515524-6.22791145 0-1.7165599-1.6515525-1.7165599-4.3396027 0-5.9911551 1.7165599-1.6515525 4.51135155-1.6515525 6.22791145 0 1.7156239 1.6506519 1.7156239 4.3405031 0 5.9911551"
                    id="window"
                  ></path>
                  <path
                    d="M9.77787671 35.2286221c-.615865.5934423-.80118608 1.8109444-.53443604 3.5228317.26019828 1.6821701.94532473 3.7794796 2.04040383 6.2496041.9939949-2.2440941 1.6510423-4.1820117 1.9599108-5.779533.4165044-2.1576444.1038921-3.2166551-.2302474-3.7236475-.3360115-.5069924-.9022703-.7555357-1.7296634-.7555357-.6720229.0009005-1.1652765.161193-1.50596779.488982v-.0027016zm2.12838449 12.4469783c-.160986.1557898-.3837456.2485433-.6224167.2485433-.3416273.001801-.6542396-.1891091-.7974422-.4862804-3.35356281-6.9159885-4.00873835-11.4275904-1.9533591-13.4051308.67857466-.6528766 1.6051801-.9833672 2.7508013-.9851682 1.8139002.0009005 2.7498653.837483 3.2150399 1.5407886 1.4619774 2.2071729.6476878 6.5296657-2.4157258 12.8477093-.0439903.0909525-.1038921.1728997-.1750254.2413392l-.001872-.001801z"
                    id="flame"
                  ></path>
                  <path
                    d="M18.5004158 19.1617363c-.3051246 4.6917057-2.4700118 7.7696808-2.8565653 8.1415953-.0028079.0027015-.2630062.2440407-1.4348345.4385529-.8180334.1377795-1.8569546.2125226-2.9248907.2125226-1.0660642 0-2.10592139-.0756437-2.92208292-.2134231-1.17182824-.1936117-1.43202652-.4349509-1.43483441-.4376524-.3856176-.371014-2.55237669-3.4498896-2.8575013-8.1415953-.3640904-5.6138375 2.12838452-11.27270103 7.21722653-16.41106435C16.3767111 7.88903527 18.86825 13.5469982 18.5032237 19.1617363h-.0028079zm1.606116 13.1709958c-.5007413-1.4075118-1.3243905-3.0068341-2.678732-4.4782827.671087-.9356396 1.554638-2.5907941 2.1630153-4.730428 1.3693168 2.6124065 1.0492168 6.4125981.5129088 9.2105117l.0028079-.001801zm-17.64762097.0045026c-.53443605-2.7997147-.85640802-6.6008068.51758867-9.2141139.60650535 2.1405345 1.48912039 3.793888 2.16301522 4.7322291-1.35434142 1.4741502-2.17986259 3.0761741-2.68060389 4.4818848zM10.6617085.93972757C7.42888523 4.05012135 5.09646033 7.34692263 3.72807943 10.7436816c-1.12596595 2.8024161-1.60424409 5.6678686-1.41985898 8.5234154.03556668.5331075.09453247 1.0500056.16847371 1.5515949C1.47614753 21.920027.80318866 23.388774.47934475 25.1862106.20323506 26.7071878.17609207 28.4740067.3923 30.4371389c.36783426 3.3013038 1.29818352 6.0073644 1.33749405 6.1217304.1366509.3935269.54847552.6330651.97433962.5682277.18812897-.0297171.35660268-.116167.48295796-.2368366.15911406-.1539888.25739039-.3665114.25926232-.5988453-.00187193-.0099058.00935965-1.1472617.44926323-2.675443.36502636-1.2616276 1.09882296-3.0392527 2.5598644-4.6340725 1.40675547.5916412 3.74386022.6672848 4.82864372.6672848 1.0819756 0 3.4200163-.0747431 4.8239638-.6672848 1.4638494 1.5948198 2.19671 3.3724449 2.5608004 4.633172.4408395 1.5317834.4511351 2.6646367.4511351 2.6745424 0 .4160399.3135483.769944.7394124.837483.2882773.0432249.5700028-.0486281.7656194-.2368366.0945325-.091853.1684738-.2035174.2105922-.3313911.0393105-.114366.9696598-2.8204266 1.3346861-6.1217304.2199518-1.9640327.1909369-3.7290506-.0823649-5.2518288-.3266518-1.7983371-.9968028-3.2634821-1.9992213-4.3666182.0758131-.4988877.132907-1.0166864.1684737-1.5515949.1843851-2.8555468-.293893-5.7209993-1.419859-8.5234154-1.3683809-3.39495793-3.7017418-6.69536129-6.9326931-9.80395403l-.6233527-.59974588-.6224168.59974588h.0028079z"
                    id="rocket"
                  ></path>
                </defs>
                <polygon
                  className="ToTopRocketBg"
                  points="11.28 1.55 15.68 6.98 17.43 10.72 19.58 17.43 19.58 21.45 21.49 24.56 21.49 30.7 19.8 34.37 16.39 27.95 11.89 28.8 6.17 27.95 3.57 31.62 2.29 35.22 .39 30.44 .96 23.4 3.57 20.82 2.92 15.92 4.69 9.95 11.28 1.55"
                ></polygon>
                <use fill="#1C5A75" xlinkHref="#rocket" id="ToTopRocket"></use>
                <use
                  fill="#1C5A75"
                  xlinkHref="#window"
                  id="ToTopRocketWindow"
                ></use>
                <use
                  fill="#FCAB10"
                  xlinkHref="#flame"
                  id="ToTopRocketFlame"
                ></use>
              </svg>
            </span>
            <span className="FooterScrollToTopText">Top</span>
          </button>
        </div>
      </div>
    </div>
  );
};

export default RocketScrollToTop;